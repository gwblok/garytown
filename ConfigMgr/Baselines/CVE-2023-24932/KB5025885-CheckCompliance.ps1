function Check-ComplianceKB5025885{
    #https://support.microsoft.com/en-us/topic/kb5025885-how-to-manage-the-windows-boot-manager-revocations-for-secure-boot-changes-associated-with-cve-2023-24932-41a975df-beb2-40c1-99a3-b3ff139f832d#bkmk_update_boot_media

    $Compliance = $true
    $SecureBootRegPath = 'HKLM:\SYSTEM\CurrentControlSet\Control\SecureBoot'

    #region Gather Info

    #Step 1 Results Confirmation - Applying the DB update
    $Step1 = [System.Text.Encoding]::ASCII.GetString((Get-SecureBootUEFI db).bytes) -match 'Windows UEFI CA 2023'
    if ($Step1 -eq $false){$Compliance = $false}

    #Step 2 Results Confirmation - Updating the boot manager
    #Check Signing Cert on bootmgfw file
    $Volume = Get-Volume | Where-Object {$_.FileSystemType -eq "FAT32" -and $_.DriveType -eq "Fixed"}
    $SystemDisk = Get-Disk | Where-Object {$_.IsSystem -eq $true}
    $SystemPartition = Get-Partition -DiskNumber $SystemDisk.DiskNumber | Where-Object {$_.IsSystem -eq $true}  
    $SystemVolume = $Volume | Where-Object {$_.UniqueId -match $SystemPartition.Guid}
    $FilePath = "$($SystemVolume.Path)\EFI\Microsoft\Boot\bootmgfw.efi"
    $CertCollection = New-Object System.Security.Cryptography.X509Certificates.X509Certificate2Collection
    $CertCollection.Import($FilePath, $null, 'DefaultKeySet')
    If ($CertCollection.Subject -like "*Windows UEFI CA 2023*") {
        $Step2 = $true
        }
    else{
        $Step2 = $false
    }
    if ($Step2 -eq $false){$Compliance = $false}

    #Step 3 Results Confirmation - Applying the DBX update
    $Step3 = [System.Text.Encoding]::ASCII.GetString((Get-SecureBootUEFI dbx).bytes) -match 'Microsoft Windows Production PCA 2011'
    if ($Step3 -eq $false){$Compliance = $false}
    #endregion Gather Info


    Write-Output "======================================================================"
    Write-Output "KB5025885: Windows Boot Manager revocations for Secure Boot changes"
    Write-Output "CVE-2023-24932 remediation Summary"
    Write-Output "======================================================================"
    Write-Output ""
    if ($Step1 -eq $true){
        Write-Output "SUCCESS: Applying the DB update |  1036 | The PCA2023 certificate was added to the DB."
    }
    else {
        Write-Output "Not Complete: Applying the DB update |  1036 | The PCA2023 certificate was added to the DB."
    }
    Write-Output "======================================================================"
    if ($Step2 -eq $true){
        Write-Output "SUCCESS: Updating the boot manager |  1799 | The PCA2023 signed boot manager was applied."
    }
    else {
        Write-Output "Not Complete: Updating the boot manager |  1799 | The PCA2023 signed boot manager was applied."
    }
    Write-Output "======================================================================"
    if ($Step3 -eq $true){
        Write-Output "SUCCESS: Applying the DBX update |  1037 | The DBX update that untrusts the PCA2011 signing certificate was applied."
    }
    else {
        Write-Output "Not Complete: Applying the DBX update |  1037 | The DBX update that untrusts the PCA2011 signing certificate was applied."
    }
    Write-Output ""
    $SecureBootRegValue = Get-ItemProperty -Path $SecureBootRegPath -Name "AvailableUpdates"
    if ($Compliance -eq $true){
        Write-Output "======================================================================"
        Write-Output ""
        Write-Output "CVE-2023-24932 SUCCESSFULLY REMEDIATED"
        Write-Output ""
        Write-Output "Current Secure Boot Registry Value: $($SecureBootRegValue.AvailableUpdates)"
        Write-Output "======================================================================"
    }
    else {
        $SecureBootRegValue = Get-ItemProperty -Path $SecureBootRegPath -Name "AvailableUpdates"
        Write-Output "======================================================================"
        Write-Output "Additional Items need to be completed for CVE-2023-24932"
        Write-Output "Current Secure Boot Registry Value: $($SecureBootRegValue.AvailableUpdates)"
        Write-Output "======================================================================"
    }
    if (Test-Path -Path HKLM:\SOFTWARE\Remediation\KB5025885){
        $Key = Get-Item -Path HKLM:\SOFTWARE\Remediation\KB5025885
        Write-Output "======================================================================"
        Write-Output ""
        Write-Output $KEY
        Write-Output ""
        Write-Output "======================================================================"
    }
}